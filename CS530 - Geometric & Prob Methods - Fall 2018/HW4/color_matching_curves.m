%% CIE 1931 2-deg, XYZ Color Matching Functions

XYZ31 = [390, 0.004243000000, 0.000120000000, 0.020050010000
395, 0.007650000000, 0.000217000000, 0.036210000000
400, 0.014310000000, 0.000396000000, 0.067850010000
405, 0.023190000000, 0.000640000000, 0.110200000000
410, 0.043510000000, 0.001210000000, 0.207400000000
415, 0.077630000000, 0.002180000000, 0.371300000000
420, 0.134380000000, 0.004000000000, 0.645600000000
425, 0.214770000000, 0.007300000000, 1.039050100000
430, 0.283900000000, 0.011600000000, 1.385600000000
435, 0.328500000000, 0.016840000000, 1.622960000000
440, 0.348280000000, 0.023000000000, 1.747060000000
445, 0.348060000000, 0.029800000000, 1.782600000000
450, 0.336200000000, 0.038000000000, 1.772110000000
455, 0.318700000000, 0.048000000000, 1.744100000000
460, 0.290800000000, 0.060000000000, 1.669200000000
465, 0.251100000000, 0.073900000000, 1.528100000000
470, 0.195360000000, 0.090980000000, 1.287640000000
475, 0.142100000000, 0.112600000000, 1.041900000000
480, 0.095640000000, 0.139020000000, 0.812950100000
485, 0.057950010000, 0.169300000000, 0.616200000000
490, 0.032010000000, 0.208020000000, 0.465180000000
495, 0.014700000000, 0.258600000000, 0.353300000000
500, 0.004900000000, 0.323000000000, 0.272000000000
505, 0.002400000000, 0.407300000000, 0.212300000000
510, 0.009300000000, 0.503000000000, 0.158200000000
515, 0.029100000000, 0.608200000000, 0.111700000000
520, 0.063270000000, 0.710000000000, 0.078249990000
525, 0.109600000000, 0.793200000000, 0.057250010000
530, 0.165500000000, 0.862000000000, 0.042160000000
535, 0.225749900000, 0.914850100000, 0.029840000000
540, 0.290400000000, 0.954000000000, 0.020300000000
545, 0.359700000000, 0.980300000000, 0.013400000000
550, 0.433449900000, 0.994950100000, 0.008749999000
555, 0.512050100000, 1.000000000000, 0.005749999000
560, 0.594500000000, 0.995000000000, 0.003900000000
565, 0.678400000000, 0.978600000000, 0.002749999000
570, 0.762100000000, 0.952000000000, 0.002100000000
575, 0.842500000000, 0.915400000000, 0.001800000000
580, 0.916300000000, 0.870000000000, 0.001650001000
585, 0.978600000000, 0.816300000000, 0.001400000000
590, 1.026300000000, 0.757000000000, 0.001100000000
595, 1.056700000000, 0.694900000000, 0.001000000000
600, 1.062200000000, 0.631000000000, 0.000800000000
605, 1.045600000000, 0.566800000000, 0.000600000000
610, 1.002600000000, 0.503000000000, 0.000340000000
615, 0.938400000000, 0.441200000000, 0.000240000000
620, 0.854449900000, 0.381000000000, 0.000190000000
625, 0.751400000000, 0.321000000000, 0.000100000000
630, 0.642400000000, 0.265000000000, 0.000049999990
635, 0.541900000000, 0.217000000000, 0.000030000000
640, 0.447900000000, 0.175000000000, 0.000020000000
645, 0.360800000000, 0.138200000000, 0.000010000000
650, 0.283500000000, 0.107000000000, 0.000000000000
655, 0.218700000000, 0.081600000000, 0.000000000000
660, 0.164900000000, 0.061000000000, 0.000000000000
665, 0.121200000000, 0.044580000000, 0.000000000000
670, 0.087400000000, 0.032000000000, 0.000000000000
675, 0.063600000000, 0.023200000000, 0.000000000000
680, 0.046770000000, 0.017000000000, 0.000000000000
685, 0.032900000000, 0.011920000000, 0.000000000000
690, 0.022700000000, 0.008210000000, 0.000000000000
695, 0.015840000000, 0.005723000000, 0.000000000000
700, 0.011359160000, 0.004102000000, 0.000000000000
705, 0.008110916000, 0.002929000000, 0.000000000000
710, 0.005790346000, 0.002091000000, 0.000000000000
715, 0.004109457000, 0.001484000000, 0.000000000000
720, 0.002899327000, 0.001047000000, 0.000000000000
725, 0.002049190000, 0.000740000000, 0.000000000000
730, 0.001439971000, 0.000520000000, 0.000000000000];

X31 = XYZ31(:,2);
Y31 = XYZ31(:,3);
Z31 = XYZ31(:,4);

% USGS Digital Spectral Library splib05a
% Clark et. al. 2003, USGS, Open File Report 03-395.

% Flower Petunia-1             W1R1Fa AREF
% 390 nm - 730 nm

P = [0.0358210
  0.0476500
  0.0619550
  0.0734340
  0.0834790
  0.0916360
  0.0961370
  0.0976420
  0.0968610
  0.0943520
  0.0908830
  0.0865940
  0.0815980
  0.0759210
  0.0692710
  0.0619080
  0.0540030
  0.0459040
  0.0382170
  0.0313990
  0.0253430
  0.0203930
  0.0165670
  0.0136620
  0.0115510
  0.0101600
  0.0093250
  0.0087810
  0.0085310
  0.0084350
  0.0085100
  0.0087360
  0.0092010
  0.0100260
  0.0114580
  0.0138950
  0.0179350
  0.0244740
  0.0345590
  0.0491200
  0.0686950
  0.0946340
  0.1240290
  0.1551250
  0.1863180
  0.2174440
  0.2467840
  0.2720830
  0.2938640
  0.3132150
  0.3298740
  0.3428580
  0.3527110
  0.3611530
  0.3678730
  0.3717890
  0.3736740
  0.3755270
  0.3782440
  0.3836580
  0.3935560
  0.4074380
  0.4220780
  0.4368930
  0.4515990
  0.4660660
  0.4794410
  0.4952440
  0.5093150];